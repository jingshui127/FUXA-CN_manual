# 🎯 FUXA 事件配置教程

---

## 📋 概述

事件功能允许您在形状和按钮控件中配置鼠标事件（click、mouseDown、mouseUp）来执行各种任务。

---

## 🎯 支持的事件类型

| 事件类型 | 说明 | 应用场景 |
|----------|------|----------|
| **click** | 点击事件 | 最常用的事件 |
| **mouseDown** | 鼠标按下事件 | 需要立即响应的场景 |
| **mouseUp** | 鼠标释放事件 | 需要在释放时执行的场景 |

---

## 🔧 支持的动作

### 动作列表

- [打开页面](#打开页面-open-page)
- [打开卡片](#打开卡片-open-card)
- [打开对话框](#打开对话框-open-dialog)
- [打开 iframe](#打开-iframe-open-iframe)
- [打开窗口](#打开窗口-open-window)
- [设置值](#设置值-set-value)
- [切换值](#切换值-toggle-value)
- [从输入设置并关闭](#从输入设置并关闭-set-from-input-and-close)

---

## 📄 打开页面 (Open Page)

### 说明

用于在主窗口中显示视图。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Open Page"**（打开页面）
4. 选择要打开的视图

![打开页面](images/fuxa-events1.gif)

### 配置示例

```javascript
// 打开页面事件配置
{
  "type": "click",
  "action": "Open Page",
  "view": "MainView",
  "transition": "fade"
}
```

---

## 🃏 打开卡片 (Open Card)

### 说明

用于将视图显示为弹出窗口。卡片将在事件发生时显示在鼠标旁边，可以同时显示多个卡片。同一个卡片可以用于例如显示多个泵的值。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Open Card"**（打开卡片）
4. 选择要打开的视图
5. 配置标签映射（可选）

![打开卡片](images/fuxa-events2.gif)

### 配置示例

```javascript
// 打开卡片事件配置
{
  "type": "click",
  "action": "Open Card",
  "view": "PumpInfoCard",
  "tagMappings": {
    "pumpName": "Pump1.name",
    "pumpStatus": "Pump1.status",
    "pumpValue": "Pump1.value"
  },
  "position": "mouse"
}
```

---

## 💬 打开对话框 (Open Dialog)

### 说明

用于将视图显示为对话框，通常用于配置值。对话框将显示在屏幕顶部。同一个对话框可以用于例如配置多个泵的值。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Open Dialog"**（打开对话框）
4. 选择要打开的视图
5. 配置标签映射

![打开对话框](images/fuxa-events3.gif)

### 配置示例

```javascript
// 打开对话框事件配置
{
  "type": "click",
  "action": "Open Dialog",
  "view": "PumpControlDialog",
  "tagMappings": {
    "pumpName": "Pump1.name",
    "pumpStatus": "Pump1.status",
    "targetValue": "Pump1.targetValue"
  },
  "title": "泵控制",
  "width": 400,
  "height": 300
}
```

---

## 🖼️ 打开 iframe (Open iframe)

### 说明

用于将窗口打开为 iframe（来自外部源的嵌入式 HTML 文档）。您可以定义窗口大小和缩放比例。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Open iframe"**（打开 iframe）
4. 输入 URL
5. 配置窗口大小和缩放比例

![打开 iframe](images/fuxa-events4.gif)

### 配置示例

```javascript
// 打开 iframe 事件配置
{
  "type": "click",
  "action": "Open iframe",
  "url": "https://example.com/dashboard",
  "width": 800,
  "height": 600,
  "zoom": 1.0
}
```

---

## 🪟 打开窗口 (Open Window)

### 说明

用于在新浏览器中打开窗口。您可以定义窗口大小。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Open Window"**（打开窗口）
4. 输入 URL
5. 配置窗口大小

![打开窗口](images/fuxa-events5.gif)

### 配置示例

```javascript
// 打开窗口事件配置
{
  "type": "click",
  "action": "Open Window",
  "url": "https://example.com/report",
  "width": 1024,
  "height": 768,
  "target": "_blank"
}
```

---

## 🔢 设置值 (Set Value)

### 说明

用于设置标签值或增加和减少当前值。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Set Value"**（设置值）
4. 选择标签
5. 设置值或选择增加/减少

![设置值](images/fuxa-events6.gif)

### 配置示例

```javascript
// 设置值事件配置
{
  "type": "click",
  "action": "Set Value",
  "tagId": "pumpStatus",
  "value": 1
}

// 增加值
{
  "type": "click",
  "action": "Set Value",
  "tagId": "temperature",
  "operation": "increase",
  "value": 5
}

// 减少值
{
  "type": "click",
  "action": "Set Value",
  "tagId": "temperature",
  "operation": "decrease",
  "value": 5
}
```

---

## 🔄 切换值 (Toggle Value)

### 说明

用于切换标签值 1/0（如果为 1 则设置为 0，如果为 0 则设置为 1）。

### 配置步骤

1. 选择要触发事件的控件
2. 添加点击事件
3. 选择动作类型为 **"Toggle Value"**（切换值）
4. 选择标签

![切换值](images/fuxa-events7.gif)

### 配置示例

```javascript
// 切换值事件配置
{
  "type": "click",
  "action": "Toggle Value",
  "tagId": "pumpStatus"
}
```

---

## ✅ 从输入设置并关闭 (Set from Input and Close)

### 说明

结合使用，可以通过带有 OK 确认的对话框设置一些值。

### 配置步骤

1. 创建对话框视图
2. 添加输入控件
3. 添加确认按钮
4. 配置按钮事件为 **"Set from Input and Close"**（从输入设置并关闭）
5. 选择要设置的标签

![从输入设置并关闭](images/fuxa-events8.gif)

### 配置示例

```javascript
// 对话框视图配置
{
  "view": "PumpControlDialog",
  "controls": [
    {
      "type": "text",
      "tagId": "pumpName",
      "text": "泵: {value}"
    },
    {
      "type": "input",
      "tagId": "targetValue",
      "label": "目标值",
      "unit": "%"
    },
    {
      "type": "button",
      "text": "确认",
      "events": [
        {
          "type": "click",
          "action": "Set from Input and Close",
          "tagId": "targetValue",
          "inputId": "targetValueInput"
        }
      ]
    }
  ]
}

// 打开对话框事件配置
{
  "type": "click",
  "action": "Open Dialog",
  "view": "PumpControlDialog",
  "tagMappings": {
    "pumpName": "Pump1.name",
    "targetValue": "Pump1.targetValue"
  }
}
```

---

## 💡 完整示例

### 示例 1：泵控制系统

```javascript
// 主视图
{
  "view": "MainView",
  "components": [
    {
      "type": "pump",
      "name": "Pump1",
      "events": [
        {
          "type": "click",
          "action": "Open Card",
          "view": "PumpInfoCard",
          "tagMappings": {
            "pumpName": "Pump1.name",
            "pumpStatus": "Pump1.status",
            "pumpValue": "Pump1.value"
          }
        }
      ]
    },
    {
      "type": "button",
      "text": "控制",
      "events": [
        {
          "type": "click",
          "action": "Open Dialog",
          "view": "PumpControlDialog",
          "tagMappings": {
            "pumpName": "Pump1.name",
            "pumpStatus": "Pump1.status",
            "targetValue": "Pump1.targetValue"
          }
        }
      ]
    }
  ]
}

// 泵信息卡片
{
  "view": "PumpInfoCard",
  "controls": [
    {
      "type": "text",
      "tagId": "pumpName",
      "text": "泵: {value}"
    },
    {
      "type": "text",
      "tagId": "pumpStatus",
      "text": "状态: {value}"
    },
    {
      "type": "text",
      "tagId": "pumpValue",
      "text": "值: {value}"
    }
  ]
}

// 泵控制对话框
{
  "view": "PumpControlDialog",
  "controls": [
    {
      "type": "text",
      "tagId": "pumpName",
      "text": "泵: {value}"
    },
    {
      "type": "input",
      "tagId": "targetValue",
      "label": "目标值",
      "unit": "%"
    },
    {
      "type": "button",
      "text": "确认",
      "events": [
        {
          "type": "click",
          "action": "Set from Input and Close",
          "tagId": "targetValue",
          "inputId": "targetValueInput"
        }
      ]
    }
  ]
}
```

### 示例 2：导航系统

```javascript
// 导航按钮
{
  "view": "MainView",
  "components": [
    {
      "type": "button",
      "text": "主页",
      "events": [
        {
          "type": "click",
          "action": "Open Page",
          "view": "HomeView"
        }
      ]
    },
    {
      "type": "button",
      "text": "设备监控",
      "events": [
        {
          "type": "click",
          "action": "Open Page",
          "view": "DeviceMonitorView"
        }
      ]
    },
    {
      "type": "button",
      "text": "报警历史",
      "events": [
        {
          "type": "click",
          "action": "Open Page",
          "view": "AlarmHistoryView"
        }
      ]
    },
    {
      "type": "button",
      "text": "数据报表",
      "events": [
        {
          "type": "click",
          "action": "Open Window",
          "url": "https://example.com/report",
          "width": 1024,
          "height": 768
        }
      ]
    }
  ]
}
```

### 示例 3：快速控制

```javascript
// 快速控制按钮
{
  "view": "MainView",
  "components": [
    {
      "type": "button",
      "text": "启动泵",
      "events": [
        {
          "type": "click",
          "action": "Set Value",
          "tagId": "pumpStatus",
          "value": 1
        }
      ]
    },
    {
      "type": "button",
      "text": "停止泵",
      "events": [
        {
          "type": "click",
          "action": "Set Value",
          "tagId": "pumpStatus",
          "value": 0
        }
      ]
    },
    {
      "type": "button",
      "text": "切换泵",
      "events": [
        {
          "type": "click",
          "action": "Toggle Value",
          "tagId": "pumpStatus"
        }
      ]
    },
    {
      "type": "button",
      "text": "增加温度",
      "events": [
        {
          "type": "click",
          "action": "Set Value",
          "tagId": "temperature",
          "operation": "increase",
          "value": 5
        }
      ]
    },
    {
      "type": "button",
      "text": "减少温度",
      "events": [
        {
          "type": "click",
          "action": "Set Value",
          "tagId": "temperature",
          "operation": "decrease",
          "value": 5
        }
      ]
    }
  ]
}
```

---

## 🔧 故障排除

### 常见问题

#### ❓ 事件不触发

**可能原因**：
- 事件未正确配置
- 控件未启用
- 权限不足

**解决方案**：
1. 检查事件配置
2. 确认控件是否启用
3. 验证用户权限

---

#### ❓ 页面不打开

**可能原因**：
- 视图不存在
- 视图名称错误
- 权限不足

**解决方案**：
1. 检查视图是否存在
2. 验证视图名称
3. 确认用户权限

---

#### ❓ 值未设置

**可能原因**：
- 标签 ID 错误
- 标签不存在
- 权限不足

**解决方案**：
1. 检查标签 ID
2. 确认标签是否存在
3. 验证用户权限

---

## 📚 最佳实践

### 1️⃣ 事件设计

- 使用合适的事件类型
- 避免事件冲突
- 提供清晰的反馈

### 2️⃣ 动作选择

- 根据需求选择合适的动作
- 组合多个动作实现复杂功能
- 测试所有动作是否正常执行

### 3️⃣ 用户体验

- 提供直观的界面
- 添加确认对话框
- 显示操作结果

### 4️⃣ 性能优化

- 避免频繁触发事件
- 优化事件处理逻辑
- 减少不必要的操作

---

## 🎉 总结

通过本教程，您已经学会了：

✅ 了解事件类型  
✅ 配置打开页面  
✅ 配置打开卡片  
✅ 配置打开对话框  
✅ 配置打开 iframe  
✅ 配置打开窗口  
✅ 配置设置值  
✅ 配置切换值  
✅ 配置从输入设置并关闭  
✅ 应用完整示例  
✅ 故障排除  
✅ 应用最佳实践  

现在您可以在 FUXA 中配置强大的事件系统了！

---

## 📚 快速参考

### 事件类型对照表

| 事件类型 | 说明 | 应用场景 |
|----------|------|----------|
| **click** | 点击事件 | 最常用的事件 |
| **mouseDown** | 鼠标按下事件 | 需要立即响应的场景 |
| **mouseUp** | 鼠标释放事件 | 需要在释放时执行的场景 |

### 动作类型对照表

| 动作类型 | 说明 | 应用场景 |
|----------|------|----------|
| **Open Page** | 打开页面 | 在主窗口中显示视图 |
| **Open Card** | 打开卡片 | 显示弹出窗口 |
| **Open Dialog** | 打开对话框 | 配置值 |
| **Open iframe** | 打开 iframe | 嵌入外部 HTML |
| **Open Window** | 打开窗口 | 在新浏览器中打开 |
| **Set Value** | 设置值 | 设置标签值 |
| **Toggle Value** | 切换值 | 切换标签值 1/0 |
| **Set from Input and Close** | 从输入设置并关闭 | 通过对话框设置值 |

---

> 💡 **提示**：建议在实际应用中为每个事件提供清晰的反馈，例如显示操作结果或确认对话框，提高用户体验。

---

**关注我们，获取更多工业自动化技术干货！** 🎯

<div style="display: flex; justify-content: center; align-items: center; gap: 40px; margin: 30px 0;">
    <div style="text-align: center;">
        <img src="images/微信公众号.jpg" alt="微信公众号" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">微信公众号</p>
    </div>
    <div style="text-align: center;">
        <img src="images/单人二维码.png" alt="技术支持" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">技术支持</p>
    </div>
</div>


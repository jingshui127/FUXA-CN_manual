# ğŸ“œ FUXA è„šæœ¬é…ç½®æ•™ç¨‹

---

## ğŸ“‹ æ¦‚è¿°

è„šæœ¬åŠŸèƒ½å…è®¸æ‚¨åœ¨ FUXA ä¸­ç¼–å†™ JavaScript å‡½æ•°ï¼Œå®ç°å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å¤„ç†ã€‚

---

## ğŸ¯ è®¿é—®è„šæœ¬é…ç½®

### æ­¥éª¤ 1ï¼šæ‰“å¼€ç¼–è¾‘å™¨

è¿›å…¥ FUXA ç¼–è¾‘å™¨ç•Œé¢ã€‚

### æ­¥éª¤ 2ï¼šè¿›å…¥è„šæœ¬è®¾ç½®

ç‚¹å‡»ç¼–è¾‘å™¨ä¸­çš„ **"Scripts"**ï¼ˆè„šæœ¬ï¼‰ã€‚

![è„šæœ¬è®¾ç½®](images/setup-scripts.png)

---

## ğŸ”§ é…ç½®è„šæœ¬

### åˆ›å»ºæ–°è„šæœ¬

æ·»åŠ ä¸€ä¸ªæ–°è„šæœ¬ï¼ˆè„šæœ¬æ˜¯ä¸€ä¸ª JavaScript å‡½æ•°ï¼‰ï¼Œé…ç½®å‡½æ•°åç§°å’Œå‚æ•°ã€‚

æœ‰ä¸¤ç§ç±»å‹çš„å‚æ•°ï¼š

| å‚æ•°ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| **Tag ID** | æ ‡ç­¾ ID | 'temperature', 'pressure' |
| **Value** | å€¼ï¼ˆæ•°å­—æˆ–å­—ç¬¦ä¸²ï¼‰ | 100, 'ON' |

### ç¼–å†™è„šæœ¬é€»è¾‘

ç„¶åæ‚¨å°†é€»è¾‘å†™å…¥å‡½æ•°ä¸­ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç³»ç»Ÿè°ƒç”¨ï¼š

| ç³»ç»Ÿè°ƒç”¨ | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| **$setTag** | è®¾ç½®æ ‡ç­¾å€¼ | $setTag('temperature', 100) |
| **$getTag** | è·å–å½“å‰æ ‡ç­¾å€¼ | $getTag('temperature') |

![é…ç½®è„šæœ¬](images/fuxa-script.gif)

### è„šæœ¬ç¤ºä¾‹

```javascript
// ç®€å•çš„è„šæœ¬ç¤ºä¾‹
function myScript(tagId, value) {
  var currentValue = $getTag(tagId);
  var newValue = currentValue + value;
  $setTag(tagId, newValue);
  return newValue;
}
```

---

## ğŸ§ª æµ‹è¯•è„šæœ¬

### ä½¿ç”¨ console.log æµ‹è¯•

æ‚¨å¯ä»¥æµ‹è¯•è„šæœ¬ï¼Œä»¥éªŒè¯å®ƒæ˜¯å¦æœ‰æ„ä¹‰ï¼Œä½¿ç”¨ console.log æ–¹æ³•ã€‚

![æµ‹è¯•è„šæœ¬](images/fuxa-script1.gif)

### æµ‹è¯•ç¤ºä¾‹

```javascript
// å¸¦æ—¥å¿—çš„è„šæœ¬
function myScript(tagId, value) {
  console.log('å¼€å§‹æ‰§è¡Œè„šæœ¬');
  console.log('æ ‡ç­¾ ID:', tagId);
  console.log('è¾“å…¥å€¼:', value);
  
  var currentValue = $getTag(tagId);
  console.log('å½“å‰å€¼:', currentValue);
  
  var newValue = currentValue + value;
  $setTag(tagId, newValue);
  console.log('æ–°å€¼:', newValue);
  
  return newValue;
}
```

---

## ğŸ”— ä» GUI é…ç½®è„šæœ¬è°ƒç”¨

### åœ¨äº‹ä»¶ä¸­è°ƒç”¨è„šæœ¬

ä» GUI æ‚¨å¯ä»¥åœ¨ **"Events"**ï¼ˆäº‹ä»¶ï¼‰ä¸­é…ç½®è„šæœ¬çš„è°ƒç”¨ã€‚

![è°ƒç”¨è„šæœ¬](images/fuxa-script2.gif)

### äº‹ä»¶é…ç½®

1. é€‰æ‹©è¦è§¦å‘è„šæœ¬çš„æ§ä»¶
2. æ·»åŠ äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»äº‹ä»¶ï¼‰
3. é€‰æ‹©åŠ¨ä½œç±»å‹ä¸º **"Execute Script"**ï¼ˆæ‰§è¡Œè„šæœ¬ï¼‰
4. é€‰æ‹©è¦æ‰§è¡Œçš„è„šæœ¬
5. é…ç½®å‚æ•°

---

## â±ï¸ å¤„ç†å®šæ—¶å™¨

### å®šæ—¶å™¨ç®¡ç†

å¦‚æœæ‚¨åœ¨è„šæœ¬ä¸­ä½¿ç”¨é—´éš”ï¼ˆintervalsï¼‰ï¼Œæ­£ç¡®å¤„ç†å®ƒä»¬éå¸¸é‡è¦ã€‚

### é—®é¢˜ç¤ºä¾‹

ä¾‹å¦‚ï¼Œå¦‚æœè„šæœ¬ä¸­æœ‰ setInterval å¹¶ä¸”å¤šæ¬¡è¿è¡Œæµ‹è¯•ï¼Œè¿™å°†æ¯æ¬¡è°ƒç”¨åŒä¸€æ®µä»£ç æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„é—´éš”ï¼Œæ‚¨å¿…é¡»é‡æ–°å¯åŠ¨ Fuxa æ¥æ¸…é™¤å®ƒã€‚

### è§£å†³æ–¹æ¡ˆ

å¤„ç†æ­¤é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯ä¸ºé—´éš”åˆ†é…ä¸€ä¸ª IDï¼Œå¹¶å¯¹å…¶è¿›è¡Œç®€å•æ£€æŸ¥ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚

```javascript
// æ£€æŸ¥å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨
if (typeof globalThis.myTimer === 'undefined') {
  globalThis.myTimer = null;
}

// å¦‚æœå®šæ—¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º
if (!globalThis.myTimer) {
  globalThis.myTimer = setInterval(myTimerFunction, 1000);
}

async function myTimerFunction() {
  // æ¯ 1 ç§’æ‰§è¡Œçš„ä»£ç 
  console.log('å®šæ—¶å™¨æ‰§è¡Œä¸­...');
  
  var value = $getTag('temperature');
  console.log('æ¸©åº¦å€¼:', value);
  
  if (value > 100) {
    $setTag('alarm', 1);
  }
}
```

### æ¸…é™¤å®šæ—¶å™¨

```javascript
// æ¸…é™¤å®šæ—¶å™¨
function clearTimer() {
  if (globalThis.myTimer) {
    clearInterval(globalThis.myTimer);
    globalThis.myTimer = null;
    console.log('å®šæ—¶å™¨å·²æ¸…é™¤');
  }
}
```

---

## ğŸ’¡ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šæ¸©åº¦æ§åˆ¶

```javascript
// æ¸©åº¦æ§åˆ¶è„šæœ¬
function temperatureControl(targetTemp) {
  var currentTemp = $getTag('temperature');
  var heaterStatus = $getTag('heaterStatus');
  
  console.log('å½“å‰æ¸©åº¦:', currentTemp);
  console.log('ç›®æ ‡æ¸©åº¦:', targetTemp);
  
  if (currentTemp < targetTemp - 2) {
    $setTag('heaterStatus', 1);
    console.log('åŠ çƒ­å™¨å¼€å¯');
  } else if (currentTemp > targetTemp + 2) {
    $setTag('heaterStatus', 0);
    console.log('åŠ çƒ­å™¨å…³é—­');
  }
  
  return heaterStatus;
}
```

### ç¤ºä¾‹ 2ï¼šæ¶²ä½ç›‘æ§

```javascript
// æ¶²ä½ç›‘æ§è„šæœ¬
function tankLevelMonitor(tankId, maxLevel, minLevel) {
  var currentLevel = $getTag(tankId + '.level');
  var pumpStatus = $getTag(tankId + '.pumpStatus');
  var alarmStatus = $getTag(tankId + '.alarmStatus');
  
  console.log('å‚¨ç½ ID:', tankId);
  console.log('å½“å‰æ¶²ä½:', currentLevel);
  
  if (currentLevel > maxLevel) {
    $setTag(tankId + '.pumpStatus', 0);
    $setTag(tankId + '.alarmStatus', 1);
    console.log('æ¶²ä½è¿‡é«˜ï¼Œæ³µåœæ­¢ï¼ŒæŠ¥è­¦è§¦å‘');
  } else if (currentLevel < minLevel) {
    $setTag(tankId + '.pumpStatus', 1);
    $setTag(tankId + '.alarmStatus', 0);
    console.log('æ¶²ä½è¿‡ä½ï¼Œæ³µå¯åŠ¨ï¼ŒæŠ¥è­¦æ¸…é™¤');
  }
  
  return alarmStatus;
}
```

### ç¤ºä¾‹ 3ï¼šæ•°æ®è®¡ç®—

```javascript
// æ•°æ®è®¡ç®—è„šæœ¬
function calculateFlowRate(pressure, pipeDiameter) {
  var flowRate = 0;
  
  if (pressure > 0 && pipeDiameter > 0) {
    var area = Math.PI * Math.pow(pipeDiameter / 2, 2);
    flowRate = pressure * area;
    
    console.log('å‹åŠ›:', pressure);
    console.log('ç®¡é“ç›´å¾„:', pipeDiameter);
    console.log('æµé‡:', flowRate);
    
    $setTag('flowRate', flowRate);
  }
  
  return flowRate;
}
```

### ç¤ºä¾‹ 4ï¼šå¤æ‚é€»è¾‘

```javascript
// å¤æ‚é€»è¾‘è„šæœ¬
function complexLogic(tagId, threshold) {
  var value = $getTag(tagId);
  var status = $getTag('systemStatus');
  var alarm = $getTag('alarm');
  
  console.log('æ ‡ç­¾å€¼:', value);
  console.log('é˜ˆå€¼:', threshold);
  console.log('ç³»ç»ŸçŠ¶æ€:', status);
  
  if (status === 1) {
    if (value > threshold) {
      $setTag('alarm', 1);
      $setTag('systemStatus', 0);
      console.log('è§¦å‘æŠ¥è­¦ï¼Œç³»ç»Ÿåœæ­¢');
      
      if (typeof globalThis.emergencyTimer === 'undefined') {
        globalThis.emergencyTimer = null;
      }
      
      if (!globalThis.emergencyTimer) {
        globalThis.emergencyTimer = setInterval(emergencyFunction, 5000);
      }
    }
  } else {
    if (value < threshold - 10) {
      $setTag('alarm', 0);
      $setTag('systemStatus', 1);
      console.log('æŠ¥è­¦æ¸…é™¤ï¼Œç³»ç»Ÿæ¢å¤');
      
      if (globalThis.emergencyTimer) {
        clearInterval(globalThis.emergencyTimer);
        globalThis.emergencyTimer = null;
      }
    }
  }
  
  return alarm;
}

function emergencyFunction() {
  console.log('ç´§æ€¥å¤„ç†ä¸­...');
  var value = $getTag('temperature');
  if (value > 50) {
    $setTag('coolingSystem', 1);
  }
}
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### â“ è„šæœ¬ä¸æ‰§è¡Œ

**å¯èƒ½åŸå› **ï¼š
- è„šæœ¬æœªæ­£ç¡®é…ç½®
- äº‹ä»¶æœªè§¦å‘
- å‚æ•°é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥è„šæœ¬é…ç½®
2. éªŒè¯äº‹ä»¶è§¦å‘æ¡ä»¶
3. ç¡®è®¤å‚æ•°æ˜¯å¦æ­£ç¡®

---

#### â“ æ ‡ç­¾å€¼æœªæ›´æ–°

**å¯èƒ½åŸå› **ï¼š
- æ ‡ç­¾ ID é”™è¯¯
- æƒé™ä¸è¶³
- è®¾å¤‡æœªè¿æ¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ ‡ç­¾ ID
2. éªŒè¯ç”¨æˆ·æƒé™
3. ç¡®è®¤è®¾å¤‡è¿æ¥çŠ¶æ€

---

#### â“ å®šæ—¶å™¨é‡å¤åˆ›å»º

**å¯èƒ½åŸå› **ï¼š
- æœªæ£€æŸ¥å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨
- å¤šæ¬¡æµ‹è¯•è„šæœ¬

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨ globalThis å­˜å‚¨å®šæ—¶å™¨ ID
2. æ£€æŸ¥å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨
3. é‡æ–°å¯åŠ¨ FUXA æ¸…é™¤å®šæ—¶å™¨

---

## ğŸ“š æœ€ä½³å®è·µ

### 1ï¸âƒ£ å‘½åè§„èŒƒ

- ä½¿ç”¨æœ‰æ„ä¹‰çš„å‡½æ•°å
- ä½¿ç”¨é©¼å³°å‘½åæ³•
- ä¾‹å¦‚ï¼š`temperatureControl`ã€`tankLevelMonitor`

### 2ï¸âƒ£ é”™è¯¯å¤„ç†

- æ·»åŠ é”™è¯¯å¤„ç†
- éªŒè¯è¾“å…¥å‚æ•°
- è®°å½•é”™è¯¯æ—¥å¿—

```javascript
function myScript(tagId, value) {
  try {
    if (!tagId) {
      throw new Error('æ ‡ç­¾ ID ä¸èƒ½ä¸ºç©º');
    }
    
    var currentValue = $getTag(tagId);
    var newValue = currentValue + value;
    $setTag(tagId, newValue);
    
    return newValue;
  } catch (error) {
    console.error('è„šæœ¬æ‰§è¡Œé”™è¯¯:', error);
    return null;
  }
}
```

### 3ï¸âƒ£ æ—¥å¿—è®°å½•

- ä½¿ç”¨ console.log è®°å½•å…³é”®ä¿¡æ¯
- è®°å½•è¾“å…¥å’Œè¾“å‡º
- ä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥

### 4ï¸âƒ£ æ€§èƒ½ä¼˜åŒ–

- é¿å…æ— é™å¾ªç¯
- åˆç†ä½¿ç”¨å®šæ—¶å™¨
- åŠæ—¶æ¸…ç†èµ„æº

---

## ğŸ‰ æ€»ç»“

é€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨å·²ç»å­¦ä¼šäº†ï¼š

âœ… è®¿é—®è„šæœ¬é…ç½®  
âœ… é…ç½®è„šæœ¬å‚æ•°  
âœ… ç¼–å†™è„šæœ¬é€»è¾‘  
âœ… æµ‹è¯•è„šæœ¬  
âœ… ä» GUI è°ƒç”¨è„šæœ¬  
âœ… å¤„ç†å®šæ—¶å™¨  
âœ… åº”ç”¨å®Œæ•´ç¤ºä¾‹  
âœ… æ•…éšœæ’é™¤  
âœ… åº”ç”¨æœ€ä½³å®è·µ  

ç°åœ¨æ‚¨å¯ä»¥åœ¨ FUXA ä¸­ç¼–å†™å¼ºå¤§çš„è„šæœ¬äº†ï¼

---

## ğŸ“š å¿«é€Ÿå‚è€ƒ

### ç³»ç»Ÿè°ƒç”¨å¯¹ç…§è¡¨

| ç³»ç»Ÿè°ƒç”¨ | è¯´æ˜ | ç¤ºä¾‹ |
|----------|------|------|
| **$getTag** | è·å–æ ‡ç­¾å€¼ | $getTag('temperature') |
| **$setTag** | è®¾ç½®æ ‡ç­¾å€¼ | $setTag('temperature', 100) |

### å®šæ—¶å™¨æ–¹æ³•å¯¹ç…§è¡¨

| æ–¹æ³• | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **setInterval** | è®¾ç½®å®šæ—¶å™¨ | setInterval(myFunction, 1000) |
| **clearInterval** | æ¸…é™¤å®šæ—¶å™¨ | clearInterval(timerId) |

---

> ğŸ’¡ **æç¤º**ï¼šå»ºè®®åœ¨è„šæœ¬ä¸­æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•å’Œé—®é¢˜æ’æŸ¥ã€‚ä½¿ç”¨ try-catch å¤„ç†é”™è¯¯ï¼Œæé«˜è„šæœ¬çš„å¥å£®æ€§ã€‚

---

**å…³æ³¨æˆ‘ä»¬ï¼Œè·å–æ›´å¤šå·¥ä¸šè‡ªåŠ¨åŒ–æŠ€æœ¯å¹²è´§ï¼** ğŸ¯

<div style="display: flex; justify-content: center; align-items: center; gap: 40px; margin: 30px 0;">
    <div style="text-align: center;">
        <img src="images/å¾®ä¿¡å…¬ä¼—å·.jpg" alt="å¾®ä¿¡å…¬ä¼—å·" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">å¾®ä¿¡å…¬ä¼—å·</p>
    </div>
    <div style="text-align: center;">
        <img src="images/å•äººäºŒç»´ç .png" alt="æŠ€æœ¯æ”¯æŒ" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">æŠ€æœ¯æ”¯æŒ</p>
    </div>
</div>


# 🔧 FUXA 安装和运行指南

---

## 📋 技术架构

FUXA 采用以下技术栈开发：

| 组件 | 技术 | 说明 |
|------|------|------|
| **后端** | Node.js | 服务器端运行环境 |
| **前端** | Angular | Web 应用框架 |

---

## 🎯 安装方式总览

FUXA 提供多种安装方式，您可以根据需求选择最适合的一种：

```
┌─────────────────────────────────────────────────────────┐
│  FUXA 安装方式                                            │
├─────────────────────────────────────────────────────────┤
│  1️⃣ 预编译 Electron 应用（推荐新手）                      │
│  2️⃣ Docker Compose（推荐生产环境）                       │
│  3️⃣ Docker（灵活部署）                                   │
│  4️⃣ 从源码构建自定义 Docker 镜像（高级用户）             │
│  5️⃣ NPM 安装（适合开发者）                                │
│  6️⃣ 最新发布版本（最简单）                                │
└─────────────────────────────────────────────────────────┘
```

---

## 方式 1️⃣：预编译 Electron 应用（推荐新手）

### 📥 下载步骤

1. 访问 GitHub Actions 页面：
   ```
   https://github.com/frangoteam/FUXA/actions/workflows/electron_latest.yml
   ```

2. 点击工作流程，滚动到底部的"Artifacts"部分

3. 点击适合您系统的下载图标

![](https://github.com/user-attachments/assets/cf0e5282-f1ef-48b3-a122-de2a2754cf19)

### ✅ 优点
- ✅ 开箱即用，无需配置
- ✅ 包含所有依赖
- ✅ 适合 Windows/Mac/Linux
- ✅ 新手友好

### 🌐 访问 FUXA

安装完成后，通过浏览器访问：
```
http://localhost:1881
```

或使用主机 IP 地址：
```
http://主机IP:1881
```

---

## 方式 2️⃣：Docker Compose（推荐生产环境）

### 📦 前置要求

已安装 Docker

### 🚀 安装步骤

#### 步骤 1：安装 Docker（如未安装）

```bash
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh ./get-docker.sh
```

#### 步骤 2：创建目录

```bash
cd
mkdir docker
mkdir fuxa
cd docker/fuxa
```

#### 步骤 3：创建 docker-compose.yml

```bash
sudo nano docker-compose.yml
```

#### 步骤 4：编辑配置文件

将以下内容粘贴到文件中：

```yaml
version: '3.5'

services:
    fuxa:
        image: frangoteam/fuxa:latest
        network_mode: "host"
        volumes:
            - ./fuxa_appdata:/usr/src/app/FUXA/server/_appdata
            - ./fuxa_db:/usr/src/app/FUXA/server/_db
            - ./fuxa_logs:/usr/src/app/FUXA/server/_logs
        environment:
            - TZ=Asia/Shanghai
        restart: always
```

**配置说明**：

| 参数 | 说明 | 建议值 |
|------|------|--------|
| `TZ` | 时区设置 | Asia/Shanghai（中国） |
| `restart` | 重启策略 | always（自动重启） |
| `network_mode` | 网络模式 | host（主机网络） |

**⚠️ 注意**：
- 此配置文件使用主机网络模式（host），使 Docker 容器与主机在同一网络
- 适合直接访问 PLC/数据库等设备
- 仅适用于 Linux 系统
- 如需在 Windows 运行，请使用桥接网络模式（bridge）

**Windows 配置**：
```yaml
network_mode: "bridge"
ports:
    - "1881:1881"
```

#### 步骤 5：启动 Docker Compose

```bash
sudo docker compose up -d
```

### ✅ 优点
- ✅ 数据持久化
- ✅ 易于备份和迁移
- ✅ 自动重启
- ✅ 生产环境推荐

---

## 方式 3️⃣：Docker（灵活部署）

### 🚀 快速启动

```bash
docker pull frangoteam/fuxa:latest
docker run -d -p 1881:1881 frangoteam/fuxa:latest
```

### 💾 持久化存储

如需持久化应用数据（项目）、历史数据（标签历史）、日志和资源图片，使用以下命令：

```bash
docker run -d \
  -p 1881:1881 \
  -v fuxa_appdata:/usr/src/app/FUXA/server/_appdata \
  -v fuxa_db:/usr/src/app/FUXA/server/_db \
  -v fuxa_logs:/usr/src/app/FUXA/server/_logs \
  -v fuxa_shapes:/usr/src/app/FUXA/client/assets/lib/svgeditor/shapes \
  -v fuxa_images:/usr/src/app/FUXA/server/_images \
  frangoteam/fuxa:latest
```

### 📂 数据卷说明

| 数据卷 | 用途 |
|--------|------|
| `fuxa_appdata` | 应用数据（项目文件） |
| `fuxa_db` | 历史数据库 |
| `fuxa_logs` | 日志文件 |
| `fuxa_shapes` | 自定义形状 |
| `fuxa_images` | 图片资源 |

---

## 方式 4️⃣：从源码构建自定义 Docker 镜像（高级用户）

### 🏗️ 构建步骤

#### 步骤 1：创建工作目录

```bash
cd
mkdir docker
mkdir fuxa
cd docker/fuxa
mkdir fuxa-build
cd fuxa-build
```

#### 步骤 2：下载 Dockerfile

```bash
wget https://raw.githubusercontent.com/frangoteam/FUXA/master/Dockerfile
```

#### 步骤 3：构建镜像

```bash
sudo docker build -t fuxa-custom-image-name --no-cache .
```

**💡 提示**：默认从最新 master 分支构建，您可以编辑 Dockerfile 修改分支。

#### 步骤 4：使用自定义镜像

创建 `docker-compose.yml`：

```yaml
version: '3.5'

services:
    fuxa:
        image: fuxa-custom-image-name
        network_mode: "host"
        volumes:
            - ./fuxa_appdata:/usr/src/app/FUXA/server/_appdata
            - ./fuxa_db:/usr/src/app/FUXA/server/_db
            - ./fuxa_logs:/usr/src/app/FUXA/server/_logs
        environment:
            - TZ=Asia/Shanghai
        restart: always
```

### ✅ 优点
- ✅ 完全自定义
- ✅ 可以修改源码
- ✅ 适合深度定制需求

---

## 方式 5️⃣：NPM 安装（适合开发者）

### 📦 前置要求

需要安装 **Node.js** 版本 18 或更高

### ⚠️ 重要提示

在 Linux 系统上使用 Node.js 18 版本时，安装可能会遇到挑战。

如果您不需要通过 S7 协议与西门子 PLC 通信，可以从以下精简版本安装：
```
@frangoteam/fuxa-min
```

### 🚀 安装步骤

```bash
npm install -g --unsafe-perm @frangoteam/fuxa
fuxa
```

### ✅ 优点
- ✅ 适合开发者
- ✅ 易于调试
- ✅ 可以修改源码

---

## 方式 6️⃣：最新发布版本（最简单）

### 📥 下载步骤

1. 访问 FUXA 发布页面：
   ```
   https://github.com/frangoteam/FUXA/releases
   ```

2. 下载最新版本的压缩包

3. 解压到本地目录

### ⚠️ 重要提示

在 Linux 系统上使用 Node.js 18 版本时，安装可能会遇到挑战。

如果您不需要通过 S7 协议与西门子 PLC 通信，可以从 `server/package.json` 中删除 `node-snap7` 库。

### 🚀 运行步骤

```bash
cd ./server
npm install
npm start
```

### ✅ 优点
- ✅ 最简单
- ✅ 无需额外工具
- ✅ 适合快速测试

---

## 🌐 访问 FUXA

无论使用哪种安装方式，完成后都可以通过浏览器访问：

```
http://localhost:1881
```

**推荐使用 Chrome 浏览器以获得最佳体验**

---

## 🖥️ 配置为 HMI（仅限 Linux）

此配置仅在 Linux 上测试过，但某些步骤可能在 Windows 上也适用。

我们将使用 Electron 而不是 Web 浏览器，因为它更轻量，且与触摸屏配合良好（可以禁用右键菜单等）。

应用程序仅访问已运行的 FUXA Web 服务器。

### 🚀 安装步骤

#### 步骤 1：更新系统

```bash
sudo apt-get update
```

#### 步骤 2：安装 Node.js 18

```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

#### 步骤 3：验证安装

```bash
node -v
npm -v
```

#### 步骤 4：安装 Electron

```bash
sudo npm install -g electron --unsafe-perm=true --allow-root
```

#### 步骤 5：创建项目目录

```bash
cd /opt
sudo mkdir electron
cd electron
sudo mkdir fuxa-electron
cd fuxa-electron
```

#### 步骤 6：初始化项目

```bash
sudo npm init -y
```

#### 步骤 7：安装 Electron 依赖

```bash
sudo npm install electron --save-dev
```

#### 步骤 8：创建主程序文件

```bash
sudo nano main.js
```

粘贴以下内容：

```javascript
const { app, BrowserWindow } = require('electron');

function createWindow() {
  const win = new BrowserWindow({
    fullscreen: true, // 启用全屏模式
    webPreferences: {
      nodeIntegration: false,
      contextIsolation: true,
    }
  });

  win.loadURL('http://localhost:1881'); // 替换为您的 Web 服务器 URL
}

app.whenReady().then(createWindow);
```

#### 步骤 9：编辑 package.json

```bash
sudo nano package.json
```

修改为：

```json
{
  "name": "fuxa-electron",
  "version": "1.0.0",
  "main": "main.js",
  "scripts": {
    "start": "electron ."
  },
  "description": "FUXA Electron HMI",
  "devDependencies": {
    "electron": "^31.3.1"
  }
}
```

#### 步骤 10：测试运行

```bash
npm start
```

#### 步骤 11：设置自动启动

创建启动脚本：

```bash
sudo nano /opt/fuxa-electron-startup.sh
```

添加以下内容：

```bash
#!/bin/bash
cd /opt/electron/fuxa-electron
npm start
```

设置执行权限：

```bash
sudo chmod +x /opt/fuxa-electron-startup.sh
```

创建系统服务：

```bash
systemctl edit --user --force --full fuxa-electron-startup.service
```

添加以下内容：

```ini
[Unit]
Description=Start Fuxa Electron Script
After=default.target

[Service]
ExecStart=/opt/fuxa-electron-startup.sh

[Install]
WantedBy=default.target
```

启用服务：

```bash
systemctl enable --user fuxa-electron-startup.service
```

### ✅ 优点
- ✅ 适合工业 HMI
- ✅ 全屏显示
- ✅ 触摸屏友好
- ✅ 自动启动

---

## 📊 安装方式对比

| 安装方式 | 难度 | 适用场景 | 推荐指数 |
|---------|------|---------|---------|
| **Electron 应用** | ⭐ | 新手、快速测试 | ⭐⭐⭐⭐⭐ |
| **Docker Compose** | ⭐⭐ | 生产环境 | ⭐⭐⭐⭐⭐ |
| **Docker** | ⭐⭐ | 灵活部署 | ⭐⭐⭐⭐ |
| **源码构建** | ⭐⭐⭐⭐ | 高级定制 | ⭐⭐⭐ |
| **NPM 安装** | ⭐⭐ | 开发者 | ⭐⭐⭐⭐ |
| **发布版本** | ⭐ | 快速测试 | ⭐⭐⭐⭐ |

---

## 💡 常见问题

### ❓ 安装后无法访问

**解决方案**：
1. 检查防火墙设置
2. 确认端口 1881 未被占用
3. 查看服务日志

### ❓ Docker 容器无法连接设备

**解决方案**：
1. 使用 `network_mode: "host"`
2. 检查网络配置
3. 确认设备在同一网络

### ❓ Linux 上 Node.js 18 安装失败

**解决方案**：
1. 使用 `@frangoteam/fuxa-min` 精简版本
2. 移除 `node-snap7` 依赖
3. 使用 Docker 部署

---

## 🎉 开始使用

安装完成后，访问 http://localhost:1881 开始使用 FUXA！

默认登录信息：
- 用户名：`admin`
- 密码：`admin`

---

> 💡 **提示**：生产环境建议使用 Docker Compose 部署，并配置数据备份策略。

---

**关注我们，获取更多工业自动化技术干货！** 🎯

<div style="display: flex; justify-content: center; align-items: center; gap: 40px; margin: 30px 0;">
    <div style="text-align: center;">
        <img src="images/微信公众号.jpg" alt="微信公众号" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">微信公众号</p>
    </div>
    <div style="text-align: center;">
        <img src="images/单人二维码.png" alt="技术支持" style="width: 200px; height: 200px; object-fit: contain;">
        <p style="margin: 10px 0 0 0; font-size: 14px; color: #666;">技术支持</p>
    </div>
</div>

